<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Categorized User Stories</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        body {
            font-family: sans-serif;
            margin: 0;
            display: flex;
            min-height: 100vh;
            background-color: #f8f9fa;
            overflow-x: hidden;
        }

        h1, h2, h3 {
            color: #343a40;
            margin: 0;
            padding: 0;
        }

        h1 {
            margin-bottom: 10px;
            text-align: center;
        }

        h2 {
            margin-bottom: 10px;
            text-align: center;
        }

        .sidebar {
            position: fixed;
            width: 300px;
            height: 100vh;
            background-color: #e9ecef;
            padding: 20px;
            border-right: 1px solid #ced4da;
            overflow-y: auto;
            box-sizing: border-box;
            flex-shrink: 0;
            z-index: 1000;
        }

        .main-content {
            margin-left: 300px;
            flex-grow: 1;
            padding: 20px;
            width: calc(100% - 250px);
            box-sizing: border-box;
            min-width: 0;
        }

        .container {
            max-width: calc(100% - 40px);
            margin: 20px auto;
            padding: 20px;
            background-color: #fff;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            box-sizing: border-box;
        }

        .nav-link {
            display: block;
            padding: 8px 16px;
            margin-bottom: 10px;
            background-color: #343a40;
            color: #fff;
            text-decoration: none;
            border-radius: 5px;
            transition: background-color 0.3s ease;
            font-size: 1rem;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .nav-link:hover {
            background-color: #0056b3;
        }

        .nav-link.active {
            background-color: #007bff;
        }

        .category {
            border: 1px solid #ced4da;
            margin-bottom: 20px;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }

        .category-header {
            background-color: #e9ecef;
            padding: 10px 15px;
            cursor: pointer;
            border-bottom: 1px solid #ced4da;
            user-select: none;
            font-weight: bold;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .category-content {
            padding: 15px;
            display: none;
            line-height: 1.6;
        }

        .description-tab {
            margin-top: 10px; 
            border: 1px solid #dee2e6; /* Light gray border */
            padding: 10px;
            border-radius: 5px;
            white-space: pre-wrap; /* Preserve line breaks and spaces */
            margin-bottom: 20px;
        }

        .expanded .category-content {
            display: block;
        }

        ul {
            list-style-type: disc;
            padding-left: 40px;
            margin: 10px 0;
        }

        li {
            margin-bottom: 5px;
        }

        .page-title {
            margin-top: 0;
            padding-top: 20px;
            font-size: 2rem;
            font-weight: bold;
            margin-bottom: 20px;
            text-align: center;
        }

        .hidden {
            display: none;
        }

        .footer {
            text-align: center;
            margin-top: 30px;
            padding: 20px;
            background-color: #e9ecef;
            border-top: 1px solid #ced4da;
            font-size: 0.8rem;
            color: #666;
        }

        .category-header::after {
            content: '\25BC';
            font-size: 12px;
            color: #555;
            transition: transform 0.3s ease;
        }

        .expanded .category-header::after {
            transform: rotate(180deg);
            content: '\25B2';
        }

        .google-form {
            margin-top: 30px;
            padding: 0;
            background-color: transparent;
            border: none;
            box-shadow: none;
            display: flex;
            justify-content: center;
            align-items: flex-start;
            overflow: hidden;
        }

        .google-form iframe {
            width: 150%;
            height: 1600px;
            border: none;
            border-radius: 0;
            overflow: hidden;
        }

        .home-button {
            position: fixed;
            top: 10px;
            left: 10px;
            background-color: #007bff;
            color: white;
            padding: 10px 15px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            z-index: 1001;
        }

        .home-button:hover {
            background-color: #0056b3;
        }

        .home-button i {
            font-size: 1.2rem;
        }

        .home-page {
            padding: 20px;
        }

        .start-button {
            display: inline-block;
            background-color: #007bff;
            color: white;
            padding: 10px 20px;
            text-decoration: none;
            border-radius: 5px;
            margin-top: 20px;
        }

        .start-button:hover {
            background-color: #0056b3;
        }

        .pattern-description {
            margin-top: 30px;
        }

        @media (max-width: 768px) {
            .google-form iframe {
                height: 2000px;
            }

            .sidebar {
                transform: translateX(-100%);
                transition: transform 0.3s ease;
            }

            .sidebar.active {
                transform: translateX(0);
            }

            .main-content {
                margin-left: 0;
                width: 100%;
            }

            .home-button {
                left: 20px;
            }
        }
    </style>
</head>

<body>
    <button class="home-button" onclick="goHome()" title="Go to Home Page">
        <i class="fas fa-home"></i>
    </button>

    <div class="sidebar" id="navigation">
        <h2>Projects</h2>
        <div id="fileLinks"></div>
    </div>

    <div class="main-content">
        <!-- This is just a big page title area -->
        <h1 class="page-title" id="mainTitle">User Story Hub</h1>

        <div class="container" id="content">
            <div id="home-content" class="content-page"></div>
        </div>
    </div>

    <script>
        const navContainer = document.getElementById('navigation');
        const contentContainer = document.getElementById('content');
        const fileLinksContainer = document.getElementById('fileLinks');
        const mainTitle = document.getElementById('mainTitle');

        // Map of JSON filenames to project titles
        const projectNames = {
            'user_stories_recycling': 'Recycling Project',
            'user_stories_federal_spending': 'Federal Spending Project',
            'user_stories_planning_poker': 'Poker Planner Project',
            'user_stories_scrum_alliance': 'Scrum Alliance Project',
            'user_stories_open_spending': 'Open Spending Project'
        };

        // Map of JSON filenames to their embedded Google Form
        const googleForms = {
            'user_stories_recycling': "https://docs.google.com/forms/d/e/1FAIpQLSeIh0r2-q7wH4-KgButqaa1Db8mlO55I0TGse7zDYtQ9yS5ZQ/viewform?embedded=true",
            'user_stories_federal_spending': "https://docs.google.com/forms/d/e/1FAIpQLSfMtAfbURj--l131BgOvsC2tp-JugqHeC7iJaHMldjC-XIPSw/viewform?embedded=true",
            'user_stories_planning_poker': "https://docs.google.com/forms/d/e/1FAIpQLScZ0h51sR51zsuGk0_l3ugya1Ys_NC4MFHpiSvgIYfruDwZ2w/viewform?embedded=true",
            'user_stories_scrum_alliance': "https://docs.google.com/forms/d/e/1FAIpQLSdTsQU-FXrMnIJXkdSnImpe5VZlKPC-cNmfdsprrKEQA7B3yA/viewform?embedded=true",
            'user_stories_open_spending': "https://docs.google.com/forms/d/e/1FAIpQLSfpr-K_5LEvpVnmxTZMycitDQg4VgjstihT9JeYgtDyGZW4zg/viewform?embedded=true"
        };

        /**
         * Build and display the user stories/categories on the page.
         */
        function displayCategories(data, fileName) {
            const contentDiv = document.getElementById(`${fileName}-content`);
            if (!contentDiv) return;

            // Clear out old content
            contentDiv.innerHTML = ''; 

            // 1) Large Title (Project Name)
            const projectTitle = document.createElement('h1');
            projectTitle.textContent = projectNames[fileName];
            contentDiv.appendChild(projectTitle);

            // 2) Description (if any)
            if (data.description) {
                const descriptionDiv = document.createElement('div');
                descriptionDiv.classList.add('description-tab');
                descriptionDiv.textContent = data.description;
                contentDiv.appendChild(descriptionDiv);
            }

            // 3) Smaller Title for "Categorized User Stories"
            const catTitle = document.createElement('h2');
            catTitle.textContent = 'Categorized User Stories';
            contentDiv.appendChild(catTitle);

            // 4) Loop over categories and build the user stories
            for (const categoryName in data) {
                // Skip 'description'
                if (categoryName === "description") continue;

                const categoryDiv = document.createElement('div');
                categoryDiv.classList.add('category');

                const headerDiv = document.createElement('div');
                headerDiv.classList.add('category-header');
                headerDiv.textContent = categoryName;
                headerDiv.addEventListener('click', () => {
                    categoryDiv.classList.toggle('expanded');
                });

                const contentUl = document.createElement('ul');
                contentUl.classList.add('category-content');
                data[categoryName].forEach(story => {
                    const storyLi = document.createElement('li');
                    storyLi.textContent = story;
                    contentUl.appendChild(storyLi);
                });

                categoryDiv.appendChild(headerDiv);
                categoryDiv.appendChild(contentUl);
                contentDiv.appendChild(categoryDiv);
            }

            // 5) Add the Google Form (if any)
            if (googleForms[fileName]) {
                const formDiv = document.createElement('div');
                formDiv.classList.add('google-form');

                const iframe = document.createElement('iframe');
                iframe.src = googleForms[fileName];
                iframe.width = '150%';
                iframe.height = '1600px'; 
                iframe.frameBorder = '0';
                iframe.marginHeight = '0';
                iframe.marginWidth = '0';
                iframe.style.border = 'none';
                iframe.style.overflow = 'hidden'; 

                formDiv.appendChild(iframe);
                contentDiv.appendChild(formDiv);
            }
        }

        /**
         * Loads a specific page (project) by filename (JSON).
         */
        function loadPage(fileName) {
            // Hide the home content
            document.getElementById('home-content').classList.add('hidden');

            // Construct the ID for the project's content container
            const contentDivId = `${fileName}-content`;
            let selectedContentDiv = document.getElementById(contentDivId);

            // Hide all other content pages
            const contentDivs = document.querySelectorAll('.content-page');
            contentDivs.forEach(div => div.classList.add('hidden'));

            // Remove 'active' from all nav links
            const navLinks = document.querySelectorAll('.nav-link');
            navLinks.forEach(link => link.classList.remove('active'));

            // Mark the clicked link as active
            const activeLink = document.querySelector(`.nav-link[data-file="${fileName}"]`);
            if (activeLink) {
                activeLink.classList.add('active');
            }

            // Set the mainTitle to the project's name (top area)
            mainTitle.textContent = projectNames[fileName];

            // If we've already loaded this content, just show it
            if (selectedContentDiv && selectedContentDiv.innerHTML.trim() !== '') {
                selectedContentDiv.classList.remove('hidden');
            } else {
                // Otherwise, fetch the JSON data and display
                fetch(`${fileName}.json`)
                    .then(response => {
                        if (!response.ok) {
                            throw new Error(`HTTP error! Status: ${response.status}`);
                        }
                        return response.json();
                    })
                    .then(data => {
                        // Create the content container if it doesn't exist yet
                        if (!selectedContentDiv) {
                            selectedContentDiv = document.createElement('div');
                            selectedContentDiv.id = contentDivId;
                            selectedContentDiv.classList.add('content-page');
                            contentContainer.appendChild(selectedContentDiv);
                        } else {
                            // Clear old content
                            selectedContentDiv.innerHTML = ''; 
                        }
                        // Build the categories/user stories
                        displayCategories(data, fileName);
                        selectedContentDiv.classList.remove('hidden');
                    })
                    .catch(error => {
                        console.error('Error loading data:', error);
                        if (!selectedContentDiv) {
                            selectedContentDiv = document.createElement('div');
                            selectedContentDiv.id = contentDivId;
                            selectedContentDiv.classList.add('content-page');
                            contentContainer.appendChild(selectedContentDiv);
                        }
                        selectedContentDiv.innerHTML = '<p>Failed to load data.</p>';
                        selectedContentDiv.classList.remove('hidden');
                    });
            }
        }

        /**
         * Initialize the navigation links for each project.
         */
        function initializePage() {
            const fileNames = Object.keys(projectNames);

            fileNames.forEach(fileName => {
                const projectName = projectNames[fileName];
                const link = document.createElement('a');
                link.classList.add('nav-link');
                link.href = `#${fileName}`;
                link.setAttribute('data-file', fileName);
                link.textContent = projectName;
                fileLinksContainer.appendChild(link);

                link.addEventListener('click', (event) => {
                    event.preventDefault();
                    loadPage(fileName);
                });
            });
        }

        /**
         * Return to Home content view, hide all project-specific content.
         */
        function goHome() {
            document.getElementById('home-content').classList.remove('hidden');

            const contentDivs = document.querySelectorAll('.content-page');
            contentDivs.forEach(div => {
                if (div.id !== 'home-content') {
                    div.classList.add('hidden');
                }
            });

            const navLinks = document.querySelectorAll('.nav-link');
            navLinks.forEach(link => link.classList.remove('active'));

            mainTitle.textContent = 'User Story Hub'; 
        }

        /**
         * Dynamically load the architectural patterns on the home page (if 'patterns.json' is available).
         */
        function displayArchitecturePatterns() {
            const homeContentDiv = document.getElementById('home-content');
            homeContentDiv.innerHTML = ''; 

            const homePageDiv = document.createElement('div');
            homePageDiv.classList.add('home-page');
            homePageDiv.innerHTML = `
                <h1>Welcome to Our User Story Hub</h1>
                <p>
                    This platform is dedicated to showcasing how AI can be leveraged in <strong>Deciding on Architectural Styles when Creating Software Architectures.</strong>
                    Explore the various projects to see categorized user stories, understand project requirements, and learn more about how AI plays a crucial role in modern software development.
                </p>
                <p>
                    Each project is carefully curated to provide insights into the decision-making process behind software architecture choices.
                    Dive into the user stories to get a better understanding of how AI can assist in creating robust and efficient software solutions.
                </p>
            `;
            homeContentDiv.appendChild(homePageDiv);

            fetch('patterns.json')
                .then(response => {
                    if (!response.ok) {
                        throw new Error(`HTTP error! Status: ${response.status}`);
                    }
                    return response.json();
                })
                .then(patterns => {
                    const patternsDiv = document.createElement('div');
                    patternsDiv.classList.add('pattern-description');

                    for (const patternName in patterns) {
                        const pattern = patterns[patternName];

                        const patternHeader = document.createElement('h3');
                        patternHeader.textContent = patternName;
                        patternsDiv.appendChild(patternHeader);

                        const patternDesc = document.createElement('p');
                        patternDesc.textContent = pattern.description;
                        patternsDiv.appendChild(patternDesc);
                    }

                    homeContentDiv.appendChild(patternsDiv);
                })
                .catch(error => {
                    console.error('Error loading architecture patterns:', error);
                    homeContentDiv.innerHTML += '<p>Failed to load architecture patterns.</p>';
                });
        }

        // Initialize the page navigation
        initializePage();

        // Display the architecture patterns on the home page by default
        displayArchitecturePatterns();
    </script>
</body>
</html>
